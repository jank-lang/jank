(cpp/raw "void throw_runtime_error() { throw std::runtime_error(\"inner error\"); }")
(cpp/raw "void throw_current() { throw; }")

(let [a (atom [])]
  (try
    (try
      (cpp/throw_runtime_error)
      (catch cpp/std.runtime_error e
        (swap! a conj :caught-inner)
        (cpp/throw_current))) ;; Rethrow using helper function
    (catch cpp/std.runtime_error e
      (swap! a conj :caught-outer)))

  (assert (= [:caught-inner :caught-outer] @a) (pr-str @a)))

:success
