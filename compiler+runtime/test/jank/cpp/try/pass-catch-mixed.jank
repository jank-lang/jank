;; Test mixing jank and C++ exception types in multiple catch
(cpp/raw "namespace jank::cpp::try_::pass_catch_mixed
          {
            void throw_cpp_int() { throw 123; }
            void throw_runtime_error() { throw std::runtime_error(\"mixed\"); }
          }")

;; Test jank exception followed by C++ catches
(assert
 (= :jank-caught
    (try
      (throw :jank-exception)
      (catch cpp/int i :cpp-int-caught)
      (catch cpp/jank.runtime.object_ref e :jank-caught))))

;; Test C++ exception followed by jank catch
(assert
 (= 123
    (try
      (cpp/jank.cpp.try_.pass_catch_mixed.throw_cpp_int)
      (catch cpp/int i i)
      (catch cpp/jank.runtime.object_ref e :jank-caught))))

;; Test that C++ std exception is caught correctly (not as jank object_ref)
(let [msg (atom nil)]
  (try
    (cpp/jank.cpp.try_.pass_catch_mixed.throw_runtime_error)
    (catch cpp/std.runtime_error ex
      (reset! msg (cpp/.what ex)))
    (catch cpp/jank.runtime.object_ref e
      (assert false "Should not reach jank catch for C++ exception")))
  (assert (not (nil? @msg)) "Should have caught C++ exception")
  (assert (= "mixed" @msg) "Error message should be 'mixed'"))

:success
